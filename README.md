# Dispatch

## Description

This is a __web application__  to facilitate seminar scheduling (avoiding schedule conflicts) 
and tracking.
Page shows the list of scheduled seminars and events,
including periodic events (_e.g._ classes and regular seminars).

See [deployed example](https://andreimikhailov.com/events)

Authorized users can login and add their own events.


## Build

### Backend

    gradle distTar

This will make `build/distributions/Dispatch.tar`

### Frontend

    cd halogens/
    ./build.sh

This will make `mainpage.js`, which should be copied to `~/.config/amkhlv/dispatch/static/` on the server.

## Config

### Prepare database

    create table users ("login" TEXT NOT NULL, "password" TEXT NOT NULL);

(the `password` is generated by `./mkhash.py`)

    create table seminars (id SERIAL, "owner" TEXT NOT NULL,"start_date" DATE NOT NULL,"start_time" TIME NOT NULL,"repeat_weeks" INTEGER NOT NULL,"description" TEXT NOT NULL,"link" TEXT NOT NULL,"show_to_group" INTEGER NOT NULL,"show_to_all" INTEGER NOT NULL);

### Two configuration files

See sample files `common.xml` and `instance.xml`


## NGINX

    location /events/static {
            rewrite /events$ / break;
            rewrite /events(.+) $1  break;
            proxy_pass http://localhost:10000;
            add_header Cache-Control "public";
            expires 30d;
    }
    location /events {
            rewrite /events$ / break;
            rewrite /events(.+) $1  break;
            proxy_pass http://localhost:10000;
    }


## Debuggin errors

instead of just:

    "/" bind GET to mainpage

surround like this:

    "/" bind GET to ServerFilters.CatchAll()(mainpage)
